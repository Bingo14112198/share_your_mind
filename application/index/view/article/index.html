<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name=" viewport" content="width=device-width   initial-scale=1.0  minimum-scale=1.0  miximum=1.0  user-scalable=yes"/>
    <title>山林小猎人</title>
    <link rel="shortcut icon" type="image/x-icon" href="__STATIC__/bird.ico">
    <link rel="stylesheet" href="__STATIC__/index/css/article.css">
    <link rel="stylesheet" href="__STATIC__/index/css/nprogress.css">
    <link rel="stylesheet" href="__STATIC__/index/css/bootstrap.min.css">
    <link rel="stylesheet" href="__STATIC__/index/layui/css/layui.css">
    <link rel="stylesheet" href="__STATIC__/mdui/css/mdui.min.css">
    <style>
        img{
            max-width: 700px;
        }
    </style>
</head>
<body>
<div class="container" id="top">
    <!--导航开始-->
    <div class="nav navbar-right">
        <nav class="navbar" role="navigation">
                <div>
                    <ul class="nav navbar-nav">
                        <li class="dropdown">
                                {if condition="$Request.session.user_head eq ''"}
                                <a href="" class="dropdown-toggle" data-toggle="dropdown" style="width: 150px;margin-left: -60px;">
                                <span style="font-size: 24px;font-weight: 700;">游客</span>&nbsp;<img src="__STATIC__/author_cover/base_author_cover.png" alt="" style="width: 40px;height: 40px;border-radius: 50%;display: inline">
                                </a>
                                {else /}
                                <a href="" class="dropdown-toggle" data-toggle="dropdown" style="margin-left: -80px;width: 300px;">
                                &nbsp;<img  src="__STATIC__/{$Request.session.user_head}" alt="" style="width: 40px;height: 40px;border-radius: 50%;display: inline-block;vertical-align: middle">
                                    <p title="{$Request.session.user_name}" style="display: inline-block;font-size:20px;font-weight:700;height:40px;max-width:200px;line-height:40px;overflow: hidden;vertical-align: middle;">{$Request.session.user_name}</p>
                                </a>
                                {/if}
                            <ul class="dropdown-menu">
                                <li><a href="{:url('index/myhome/index')}">我的主页</a></li>
                                <li><a href="{:url('index/myhome/index')}">收藏的文章</a></li>
                                <li><a href="{:url('index/myhome/index')}">喜欢的文章</a></li>
                                <li><a href="{:url('index/mymoney/index')}">我的打赏</a></li>
                                <li><a href="{:url('index/setting/index')}">设置</a></li>
                                <li><a href="{:url('index/login/logout')}">退出</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
        </nav>
    </div>
    <!--导航结束-->
    <div class="note">
        <div class="post">
            <div class="article">
                <h1 class="title">{$article.article_name}</h1>
            </div>
            <!--作者区域开始-->
            <div class="author" style="margin-top: 20px;">
                <a class="avatar" href=""><img src="__STATIC__/{$article.author_cover}" alt=""></a>
                <div class="info" >
                    <span class="tag">作者</span>
                    <span class="name"><a href="">{$article.author}</a></span>
                    <span class="mdui-btn mdui-ripple mdui-ripple-white" data-toggle="modal" id="give-money" data-target="#money"  style="background-color: #ea6f5a;color: white;border-radius: 14px;">打赏作者</span>
                    <span class="mdui-btn mdui-ripple mdui-ripple-white" id="focus" style="background-color: #42c02e;color: white;border-radius: 14px;">添加关注</span>
                    <div class="meta">
                        <span class="publis-time " title=""  data-toggle="popover" data-placement="bottom" data-container="body" data-trigger="hover"  data-content="最后编辑于 {$article.time}">{$article.time}</span>
                        <span>阅读 {$article.click}</span>
                        <span>评论 {$article.comment_num}</span>
                        <span>喜欢 {$article.like} </span>
                    </div>

                </div>
            </div>
            <!--作者区域结束-->
            <!--文章内容开始-->
            <div class="show-content">
                {$article.content}
            </div>
            <!--文章内容结束-->
            <div class="show-foot">
                <div class="copyright" data-toggle="popover" data-placement="top" data-content="转载文章请联系作者获得许可" data-container="body" data-trigger="hover">&copy;文章版权归作者所有</div>
            </div>
            <!--喜欢开始-->
            <div class="meta-bottom">
                <div  class="like "   >
                    <div class="btn-like">
                        <span class="glyphicon glyphicon-heart-empty"></span>喜欢
                    </div>
                    <div class="num">{$article.like}</div>
                </div>
            </div>
            <!--喜欢结束-->
        </div>
        <!--隐藏域开始-->
        <input type="text" id="article-id" value="{$article.id}" hidden>
        <input type="text" id="author" value="{$article.author}" hidden>
        <!--隐藏域结束-->
        <!--右侧工具开始-->
        <div class="side-tool">
            <ul>
                <li class="gotop" data-placement="left" data-toggle="popover" data-container="body" data-trigger="hover" data-content="回到顶部" style="display: none">
                    <a><span class="glyphicon glyphicon-chevron-up"></span></a>
                </li>
                <li class="heart" data-placement="left" data-toggle="popover" data-container="body" data-trigger="hover" data-content="收藏文章">
                    <a><span class="glyphicon glyphicon-heart-empty"></span></a>
                </li>
            </ul>
        </div>
        <!--右侧工具结束-->
    </div>
    <!--左边菜单开始-->
    <div class="menu-show">
        <button data-container="body" data-toggle="popover" data-placement="right" data-content="列表在这哦" data-trigger="hover" class=" btn btn-default"><span class="glyphicon glyphicon-list"></span></button>
    </div>
    <div class="menu-content" id="side-menu" style="overflow:auto;">
        <div class="menu-list">
            <h4 style="font-size: 18px;margin-top: 10px;margin-bottom: 10px;">Little Trouble Maker</h4>
            <h4 style="font-size: 18px;margin-top: 10px;margin-bottom: 10px;">And</h4>
            <h4 style="font-size: 18px;margin-top: 10px;margin-bottom: 10px;">Big Trouble Maker</h4>
            <h4></h4>
            <ul >
                <li style="text-align: center;font-size: 18px;"><a href="{:url('index/index/index')}">首页</a></li>
                <li style="text-align: center;font-size: 18px;"><a target="_blank" href="{:url('index/write/index')}">写文章</a></li>
                {volist name="cates" id="vo"}
                <li style="text-align: center;font-size: 18px;"><a href="{:url('index/cates/index',array('id'=>$vo.id))}">{$vo.cate_name}</a></li>
                {/volist}
            </ul>
            <form action="{:url('index/search/index')}" method="post">
                <div class="form-group">
                    <input  type="text" class="form-control search" placeholder="请输入关键词" name="keywords">
                </div>
            </form>
        </div>
    </div>
    <!--左边菜单结束-->
</div>
<!--评论开始-->
<div class="comment">
    <div class="comment-num" style="font-size: 25px;">
        <span><i class="layui-icon" style="font-size: 25px;color: #FF5722;">&#xe63a;</i>   {$article.comment_num}条评论</span>
    </div>
    <div class="comment-list">
        <ul>
            {volist name="comments" id="vo"}
            <li><img style="width: 40px;height: 40px;border-radius: 50%" src="__STATIC__/{$vo.user_head}" alt="">  <span style="font-size: 16px;font-weight: 700;">{$vo.user_name}</span>&nbsp;:&nbsp;<span style="font-size: 16px;">{$vo.comment}</span> <span style="float: right;font-size: 16px;">{$vo.time}</span></li>
            {/volist}
        </ul>
    </div>
    <div class="layui-form" >
        <div class="layui-form-item layui-form-text">
            <label class="layui-form-label" style="font-size: 20px;">评论</label>
            <div class="layui-input-block">
                <textarea name="desc" placeholder="请输入内容" class="layui-textarea"></textarea>
            </div>
        </div>
        <div class="layui-form-item">
            <div class="layui-input-block">
                <button class="layui-btn submit" lay-submit lay-filter="formDemo">立即提交</button>
            </div>
        </div>
    </div>
</div>
<!--评论结束-->
<!--支付模态框开始-->
<div class="modal fade" id="money" tabindex="-1" role="dialog" aria-hidden="true">
    <div class="modal-dialog">
            <div class="mdui-tab mdui-tab-centered" style="color: white">
                <a id="#alli" class="mdui-ripple" style="font-size: 24px;">支付宝</a>
                <a id="#weixin" class="mdui-ripple" style="font-size: 24px;">微信</a>
            </div>
        {if condition="$pay.allipay neq ''"}
        <div id="allipay" class="mdui-p-a-2"><img style="display:block;margin: 0 auto;width: 320px;height: 320px;" src="__STATIC__/{$pay.allipay}" alt=""></div>
        {/if}
        {if condition="$pay.weixin neq ''"}
        <div id="weixinpay"  class="mdui-p-a-2"><img style="display:block;margin: 0 auto;width: 320px;height: 320px;" src="__STATIC__/{$pay.weixin}" alt=""></div>
        {/if}
    </div>
</div>
<!--支付模态框结束-->
<div >
    <div style="margin: 0 auto;vertical-align:middle;text-align: center;font-size: 13px;padding: 20px;">Copyright @ 2017 Zbingo.me 备案号：陕ICP备：17007989号</div>
</div>
<!--//百度分享-->
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"slide":{"type":"slide","bdImg":"0","bdPos":"right","bdTop":"100"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>

<script src="__STATIC__/admin/js/jquery-3.2.1.min.js"></script>
<script src="__STATIC__/layer/layer.js"></script>
<script src="__STATIC__/index/js/bootstrap.min.js"></script>
<script src="__STATIC__/index/js/canvas-nest.min.js" color="234,111,90" opacity="0.3" zIndex="-134" ></script>
<script src="__STATIC__/index/js/nprogress.js"></script>
<script src="__STATIC__/mdui/js/mdui.min.js"></script>
<script src="__STATIC__/index/js/article.js"></script>
<script>
    $(".like").click(function () {
        var num = parseInt($(this).find('.num').text());
        var id = $('#article-id').val();
        var url = "{:url('index/like/like')}";
        if($(this).hasClass('active')){
            $(this).css('background-color','transparent');
            $(this).css('color','#ea6f5a');
            $(this).find('.num').text(num - 1);
            $(this).removeClass('active');
            $.post(url, {
                'id': id,
                'action':2
            }, function (data) {
                var mes = data.mes;
                if(data.state == 3){
                    layer.msg(mes, {icon: 5, time: 3000});
                    setTimeout(function () {
                        location.href = "{:url('index/login/login')}";
                    },2000);
                }else if(data.state === 1) {
                    layer.msg(mes, {icon: 6, time: 1000});
                }else {
                    layer.msg(mes, {icon: 5, time: 1000});
                }
            });
        }else {
            $(this).css('background-color', '#ea6f5a');
            $(this).css('color', '#fff');
            $(this).find('.num').text(num + 1);
            $(this).addClass('active');
            $.post(url, {
                'id': id,
                'action':1
            }, function (data) {
                var mes = data.mes;
                if(data.state == 1){
                    layer.msg(mes, {icon: 6, time: 1000});
                }else if (data.state == 2){
                    layer.msg(mes, {icon: 5, time: 3000});
                }else {
                    layer.msg(mes, {icon: 5, time: 3000});
                    setTimeout(function () {
                        location.href = "{:url('index/login/login')}";
                    },2000);
                }
            });
        }

    });

    //收藏文章
    //点击红心
    $('.heart').click(function () {
        $(this).find('span').attr('class','glyphicon glyphicon-heart');
        $(this).find('span').css('color','rgb(255,73,67)');
        var id = $('#article-id').val();
        var url = "{:url('index/collection/index')}";
        $.post(url,{
            'id':id
        },function (data) {
            var mes = data.mes;
            if(data.state == 1){
                layer.msg(mes, {icon: 6, time: 1000});
            }else if (data.state == 2){
                layer.msg(mes, {icon: 5, time: 1000});
            }else {
                layer.msg(mes, {icon: 5, time: 3000});
                setTimeout(function () {
                    location.href = "{:url('index/login/login')}";
                },2000);
            }
        });
    });

    //评论
    $('button.submit').click(function () {
        var msg = $('.layui-textarea').val();
        var id = $('#article-id').val();
        var url = "{:url('index/comment/index')}";
        $.post(url,{
            'id':id,
            'msg' : msg
        },function (data) {
            var mes = data.mes;
            if(data.state == 1){
                layer.msg(mes, {icon: 6, time: 1000});
            }else if (data.state == 2){
                layer.msg(mes, {icon: 5, time: 3000});
            }else {
                layer.msg(mes, {icon: 5, time: 3000});
                setTimeout(function () {
                    location.href = "{:url('index/login/login')}";
                },2000);
            }
        });
    });

    //关注
    $('#focus').click(function () {
        var author = $('#author').val();
        var url = "{:url('index/focus/add')}";
        $.post(url,{
            'author':author
        },function (data) {
            var mes = data.mes;
            if(data.state == 1){
                layer.msg(mes,{icon:6,time:1000});
            }else if (data.state == 2){
                layer.msg(mes,{icon:5,time:3000});
            }else if(data.state == 3){
                layer.msg(mes,{icon:6,time:1000});
            }else {
                layer.msg(mes,{icon:5,time:3000});
                setTimeout(function () {
                    location.href = "{:url('index/login/login')}"
                },2000);
            }
        });
    });
</script>
<script>(function(T,h,i,n,k,P,a,g,e){g=function(){P=h.createElement(i);a=h.getElementsByTagName(i)[0];P.src=k;P.charset="utf-8";P.async=1;a.parentNode.insertBefore(P,a)};T["ThinkPageWeatherWidgetObject"]=n;T[n]||(T[n]=function(){(T[n].q=T[n].q||[]).push(arguments)});T[n].l=+new Date();if(T.attachEvent){T.attachEvent("onload",g)}else{T.addEventListener("load",g,false)}}(window,document,"script","tpwidget","//widget.seniverse.com/widget/chameleon.js"))</script>
<script>tpwidget("init", {
    "flavor": "bubble",
    "location": "WX4FBXXFKE4F",
    "geolocation": "enabled",
    "position": "bottom-right",
    "margin": "0px 0px",
    "language": "zh-chs",
    "unit": "c",
    "theme": "chameleon",
    "uid": "U676968700",
    "hash": "358cdcce89730edf2ec9d83787748129"
});
tpwidget("show");</script>
</body>

</html>